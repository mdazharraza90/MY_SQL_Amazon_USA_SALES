# MY_SQL_Amazon_USA_SALES
Amazon USA Sales Analysis

* I worked on a project where I analyzed over 20,000 sales records from an e-commerce platform similar to Amazon. I used MySQL to study customer behavior, product performance, and sales trends.

* As part of the project, I wrote different SQL queries to answer business questions like tracking revenue, segmenting customers, and managing inventory. I also cleaned the data and handled missing values to make sure the analysis was accurate.

# Dataset Overview:

* The project uses 9 tables: Customers, Products, Categories, Sellers, Orders, Order Items, Shipping, Payments, and Inventory.

* Relationships were established through primary and foreign keys to ensure data integrity and enable complex queries.

* To make the database structure easy to understand, I included an ERD (Entity Relationship Diagram) that shows how the tables are related.

# Entity Relationship Diagram
![image alt](https://github.com/mdazharraza90/MY_SQL_Amazon_USA_SALES/blob/203efa3433ad65157aa43063b7e86abce911ef32/Screenshot%202025-09-17%20132938.png)


# Tables Creation
<pre> ``` sql
-- Amazon Project - Advanced SQL 

-- Create table 

DROP TABLE IF EXISTS shippings;
DROP TABLE IF EXISTS payments;
DROP TABLE IF EXISTS inventory;
DROP TABLE IF EXISTS order_items;
DROP TABLE IF EXISTS orders;
DROP TABLE IF EXISTS sellers;
DROP TABLE IF EXISTS customers;
DROP TABLE IF EXISTS products;
DROP TABLE IF EXISTS category;


-- category TABLE
CREATE TABLE category
(
category_id	INT PRIMARY KEY,
category_name VARCHAR(20)
);

-- customers TABLE

CREATE TABLE customers
(
customer_id INT PRIMARY KEY,	
first_name	VARCHAR(20),
last_name	VARCHAR(20),
state VARCHAR(20)
);

-- sellers TABLE
CREATE TABLE sellers
(
seller_id INT PRIMARY KEY,
seller_name	VARCHAR(25),
origin VARCHAR(15)
);

-- updating data types
ALTER TABLE sellers
ALTER COLUMN origin TYPE VARCHAR(10)
;

-- products table
CREATE TABLE products
(
product_id INT PRIMARY KEY,	
product_name VARCHAR(50),	
price	FLOAT,
cogs	FLOAT,
category_id INT, -- FK 
CONSTRAINT product_fk_category FOREIGN KEY(category_id) REFERENCES category(category_id)
);

-- orders
CREATE TABLE orders
(
order_id INT PRIMARY KEY, 	
order_date	DATE,
customer_id	INT, -- FK
seller_id INT, -- FK 
order_status VARCHAR(15),
CONSTRAINT orders_fk_customers FOREIGN KEY (customer_id) REFERENCES customers(customer_id),
CONSTRAINT orders_fk_sellers FOREIGN KEY (seller_id) REFERENCES sellers(seller_id)
);

CREATE TABLE order_items
(
order_item_id INT PRIMARY KEY,
order_id INT,	-- FK 
product_id INT, -- FK
quantity INT,	
price_per_unit FLOAT,
CONSTRAINT order_items_fk_orders FOREIGN KEY (order_id) REFERENCES orders(order_id),
CONSTRAINT order_items_fk_products FOREIGN KEY (product_id) REFERENCES products(product_id)
);

-- payment TABLE
CREATE TABLE payments
(
payment_id	
INT PRIMARY KEY,
order_id INT, -- FK 	
payment_date DATE,
payment_status VARCHAR(20),
CONSTRAINT payments_fk_orders FOREIGN KEY (order_id) REFERENCES orders(order_id)
);


CREATE TABLE shippings
(
shipping_id	INT PRIMARY KEY,
order_id	INT, -- FK
shipping_date DATE,	
return_date	 DATE,
shipping_providers	VARCHAR(15),
delivery_status VARCHAR(15),
CONSTRAINT shippings_fk_orders FOREIGN KEY (order_id) REFERENCES orders(order_id)
);



CREATE TABLE inventory
(
inventory_id INT PRIMARY KEY,
product_id INT, -- FK
stock INT,
warehouse_id INT,
last_stock_date DATE,
CONSTRAINT inventory_fk_products FOREIGN KEY (product_id) REFERENCES products(product_id)
);
``` </pre>

# Advanced Business Problems:

1. Top Selling Products
*	 Query: Top 10 products by total sales value.
*	 Challenge: Include product name, total quantity sold, and total sales value.

2. Revenue by Category
   *  Query: Total revenue generated by each product category.
   *  Challenge: Include the percentage contribution of each category to total revenue.

3. Average Order Value (AOV)
* Query: Compute the average order value for each customer.
* Challenge: Include only customers with more than 5 orders.

4. Monthly Sales Trend
* Query: Monthly total sales over the past year.
* Challenge: Display the sales trend, grouping by month, return current_month sale, last month sale.
  
5.Customers with No Purchases
* Query: Find customers who have registered but never placed an order.
* Challenge: List customer details and the time since their registration.

6. Least-Selling Categories by State
* Query: Identify the least-selling product category for each state.
* Challenge: Include the total sales for that category within each state.

7. Customer Lifetime Value (CLTV)
* Query: Calculate the total value of orders placed by each customer over their lifetime.
* Challenge: Rank customers based on their CLTV.

8. Inventory Stock Alerts
* Query: Products with stock levels below a certain threshold (e.g., less than 10 units).
* Challenge: Include last restock date and warehouse information.

9. Shipping Delays
* 	Query: Identify orders where the shipping date is later than 3 days after the order date.
* Challenge: Include customer, order details, and delivery provider.

10. Payment Success Rate
* Query: Calculate the percentage of successful payments across all orders.
* Challenge: Include breakdowns by payment status (e.g., failed, pending).

11. Top Performing Sellers
* Query: Find the top 5 sellers based on total sales value.
* Challenge: Include both successful and failed orders, and display their percentage of successful orders.

12. Product Profit Margin
* Query: Calculate the profit margin for each product (difference between price and cost of goods sold).
* Challenge: Rank products by their profit margin, showing highest to lowest.

13. Most Returned Products
* Query: Top 10 products by the number of returns.
* Challenge: Display the return rate as a percentage of total units sold for each product.

14. Orders Pending Shipment
* Query: Find orders that have been paid but are still pending shipment.
* Challenge: Include order details, payment date, and customer information.

15. Identify Returning or New Customers
* Query: Categorize customers as returning or new based on their return behavior.
* Challenge: List customer ID, name, total orders, and total returns.

16. Top 5 Customers by Orders in Each State
* Query: Identify the top 5 customers with the highest number of orders for each state.
* Challenge: Include the number of orders and total sales for each customer.

17. Revenue by Shipping Provider
* Query: Calculate the total revenue handled by each shipping provider.
* Challenge: Include the total number of orders handled and the average delivery time for each provider.


